"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9346],{9346:(b,u,o)=>{o.r(u),o.d(u,{InteressesPageModule:()=>O});var f=o(177),p=o(4341),a=o(4742),d=o(9384),P=o(1182),h=o(467),e=o(4438),v=o(2557),m=o(1626);let _=(()=>{var r;class i{constructor(s){this.http=s,this.API_URL="../../../assets/json/preferences.json"}getPreferences(){return this.http.get(this.API_URL)}}return(r=i).\u0275fac=function(s){return new(s||r)(e.KVO(m.Qq))},r.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),i})();var I=o(1339),g=o(6340),M=o(2872);function F(r,i){if(1&r){const n=e.RV6();e.j41(0,"ion-chip")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-icon",7),e.bIt("click",function(){const t=e.eBV(n).$implicit,c=e.XpG(2);return e.Njj(c.removePreference(t))}),e.k0s()()}if(2&r){const n=i.$implicit;e.R7$(2),e.JRh(n.preferencia)}}function C(r,i){if(1&r&&(e.j41(0,"div")(1,"h4"),e.EFF(2,"Minhas prefer\xeancias"),e.k0s(),e.j41(3,"div",5),e.DNE(4,F,4,1,"ion-chip",6),e.k0s()()),2&r){const n=e.XpG();e.R7$(4),e.Y8G("ngForOf",n.selectedPreferences)}}function T(r,i){if(1&r){const n=e.RV6();e.j41(0,"ion-chip",10),e.bIt("click",function(){const t=e.eBV(n).$implicit,c=e.XpG(3);return e.Njj(c.selectPreference(t))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&r){const n=i.$implicit;e.R7$(2),e.JRh(n.preferencia)}}function j(r,i){if(1&r&&(e.j41(0,"div")(1,"h5"),e.EFF(2),e.k0s(),e.DNE(3,T,3,1,"ion-chip",9),e.k0s()),2&r){const n=i.$implicit;e.R7$(2),e.JRh(n.categoria),e.R7$(),e.Y8G("ngForOf",n.preferencias)}}function R(r,i){if(1&r&&(e.j41(0,"div",8),e.DNE(1,j,4,2,"div",6),e.k0s()),2&r){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.filteredPreferences)}}const k=[{path:"",component:(()=>{var r;class i{constructor(s,t,c,l,E,S,$){this.livrosService=s,this.prefService=t,this.authService=c,this.router=l,this.firestore=E,this.navCtrl=S,this.toastController=$,this.preferences=[],this.filteredPreferences=[],this.selectedPreferences=[],this.searchTerm=""}ngOnInit(){this.loadPreferences()}loadPreferences(){var s=this;return(0,h.A)(function*(){s.prefService.getPreferences().subscribe(t=>{s.preferences=t,s.filteredPreferences=[...s.preferences]})})()}filterPreferences(){if(""===this.searchTerm.trim())this.filteredPreferences=[...this.preferences];else{const s=this.searchTerm.toLowerCase();this.filteredPreferences=this.preferences.map(t=>({categoria:t.categoria,preferencias:t.preferencias.filter(c=>c.preferencia.toLowerCase().includes(s))})).filter(t=>t.preferencias.length>0)}}selectPreference(s){this.selectedPreferences.find(c=>c.id===s.id)||(this.selectedPreferences.push(s),this.filteredPreferences.filter(c=>c.id!==s.id))}removePreference(s){this.selectedPreferences=this.selectedPreferences.filter(t=>t.id!==s.id),this.filteredPreferences.push(s)}presentToast(s){var t=this;return(0,h.A)(function*(){yield(yield t.toastController.create({message:s,duration:2e3,position:"bottom"})).present()})()}savePreferences(){var s=this;return(0,h.A)(function*(){try{const t=yield s.authService.getUserId();if(!t)return void s.presentToast("Usu\xe1rio n\xe3o autenticado.");const c={interesses_usuario:s.selectedPreferences,updatedAt:new Date};yield s.firestore.collection("users").doc(t).set(c,{merge:!0}),s.presentToast("Prefer\xeancias salvas com sucesso!"),s.livrosService.setAdd("bio"),s.router.navigate(["/pesquisar"])}catch(t){console.error("Erro ao salvar prefer\xeancias:",t),s.presentToast("Ocorreu um erro ao salvar as prefer\xeancias.")}})()}}return(r=i).\u0275fac=function(s){return new(s||r)(e.rXU(v.t),e.rXU(_),e.rXU(I.u),e.rXU(d.Ix),e.rXU(g.Qe),e.rXU(M.q9),e.rXU(a.K_))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-interesses"]],decls:12,vars:3,consts:[[1,"ion-padding"],["placeholder","Buscar interesses","debounce","500",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],["expand","full",3,"click"],["class","preference-list",4,"ngIf"],[1,"selected-chips"],[4,"ngFor","ngForOf"],["name","close-circle",3,"click"],[1,"preference-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(s,t){1&s&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Selecione Interesses"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"ion-searchbar",1),e.mxI("ngModelChange",function(l){return e.DH7(t.searchTerm,l)||(t.searchTerm=l),l}),e.bIt("ionInput",function(){return t.filterPreferences()}),e.k0s(),e.DNE(6,C,5,1,"div",2),e.j41(7,"ion-button",3),e.bIt("click",function(){return t.savePreferences()}),e.EFF(8,"Salvar Prefer\xeancias"),e.k0s(),e.j41(9,"h4"),e.EFF(10,"Prefer\xeancias"),e.k0s(),e.DNE(11,R,2,1,"div",4),e.k0s()),2&s&&(e.R7$(5),e.R50("ngModel",t.searchTerm),e.R7$(),e.Y8G("ngIf",t.selectedPreferences.length>0),e.R7$(5),e.Y8G("ngIf",t.filteredPreferences.length>0))},dependencies:[f.Sq,f.bT,p.BC,p.vS,a.Jm,a.ZB,a.W9,a.eU,a.iq,a.he,a.S1,a.BC,a.ai,a.Gw],styles:[".selected-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:10px}.selected-chips[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:5px;--background: #ffdd57a6;--color: #000}.preference-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.preference-list[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:5px;--background: #f4f4f4;--color: #555;cursor:pointer;transition:background-color .3s ease-in-out}.preference-list[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]:hover{--background: #cce7ff}h4[_ngcontent-%COMP%]{margin-top:20px;color:#333}"]}),i})()}];let y=(()=>{var r;class i{}return(r=i).\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[d.iI.forChild(k),P.X8,d.iI]}),i})(),O=(()=>{var r;class i{}return(r=i).\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[f.MD,p.YN,a.bv,g.cM,y]}),i})()}}]);