"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2983],{2983:(y,g,n)=>{n.r(g),n.d(g,{BioPageModule:()=>R});var v=n(177),u=n(4341),a=n(4742),d=n(9384),h=n(467),e=n(4438),f=n(6589),p=n(2872),m=n(1339),x=n(1893);function P(i,s){1&i&&e.nrm(0,"ion-progress-bar",10)}const M=[{path:"",component:(()=>{var i;class s{constructor(o,t,r,l,C){this.firestoreService=o,this.navCtrl=t,this.route=r,this.authService=l,this.storage=C,this.livroId="",this.tituloLivro="",this.textoResenha="",this.tituloResenha="",this.isSaving=!1,this.userId=null,this.biografia="",this.categorias_livro=[]}ionViewWillEnter(){var o=this;return(0,h.A)(function*(){if(o.route.queryParams.subscribe(t=>{if(t.livro)try{const r=JSON.parse(t.livro);console.log(r),o.livroId=r.id||"",o.tituloLivro=r.volumeInfo.title||"",o.categorias_livro=r.volumeInfo.categories,console.log("variavel depois de associar: ",o.tituloLivro),console.log("recebido variavel: ",r.title)}catch(r){console.error("Erro ao processar dados do livro:",r)}}),o.userId=yield o.authService.getUserId(),o.userId)try{const t=yield o.firestoreService.getPerfil(o.userId).toPromise();o.biografia=(null==t?void 0:t.biografia)||""}catch(t){console.error("Erro ao recuperar o perfil do usu\xe1rio:",t)}else console.error("Usu\xe1rio n\xe3o autenticado!")})()}enviarResenha(){var o=this;return(0,h.A)(function*(){if(!o.textoResenha.trim())return void console.error("A resenha est\xe1 vazia!");const t={livroId:o.livroId,titulo_resenha:o.tituloResenha,nome_livro:o.tituloLivro,resenha:o.textoResenha,categorias_livro:o.categorias_livro||"",data:new Date};try{if(o.isSaving=!0,!o.userId)return void console.error("Usu\xe1rio n\xe3o autenticado!");console.log("usuario logado?",o.userId),yield o.firestoreService.addResenhaUsuario(o.userId,t),console.log("Resenha salva com sucesso!");const r={id:o.livroId,title:o.tituloLivro};yield o.storage.excluirDaEstante(r.id,"-TODOS"),yield o.storage.adicionarNaEstante(r,"-RESENHADOS"),o.navCtrl.navigateForward("tabs/estante")}catch(r){console.error("Erro ao salvar a resenha:",r)}finally{o.isSaving=!1}})()}}return(i=s).\u0275fac=function(o){return new(o||i)(e.rXU(f.B),e.rXU(p.q9),e.rXU(d.nX),e.rXU(m.u),e.rXU(x.b))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-bio"]],decls:20,vars:4,consts:[["color","primary"],[1,"description-container"],[1,"title-input"],["type","text","labelPlacement","floating",3,"ngModelChange","ngModel"],["slot","label"],[1,"custom-textarea-container"],["id","customTextarea","placeholder","Compartilhe os sentimentos que este livro despertou em voc\xea, sem ser expl\xedcito. N\xe3o se preocupe, o mist\xe9rio faz parte da divers\xe3o!",1,"custom-textarea",3,"ngModelChange","ngModel"],["expand","block",3,"click"],[1,"progress-indicator"],["type","indeterminate",4,"ngIf"],["type","indeterminate"]],template:function(o,t){1&o&&(e.j41(0,"ion-content")(1,"ion-header")(2,"ion-toolbar",0)(3,"ion-title"),e.EFF(4),e.k0s()()(),e.j41(5,"div",1)(6,"ion-label")(7,"h2"),e.EFF(8,"Conte para o mundo o que torna este livro especial para voc\xea"),e.k0s()(),e.j41(9,"ion-item",2)(10,"ion-input",3),e.mxI("ngModelChange",function(l){return e.DH7(t.tituloResenha,l)||(t.tituloResenha=l),l}),e.j41(11,"div",4),e.EFF(12,"T\xedtulo da Resenha"),e.k0s()()(),e.j41(13,"div",5)(14,"textarea",6),e.mxI("ngModelChange",function(l){return e.DH7(t.textoResenha,l)||(t.textoResenha=l),l}),e.EFF(15,"      "),e.k0s()(),e.j41(16,"ion-button",7),e.bIt("click",function(){return t.enviarResenha()}),e.EFF(17,"Enviar"),e.k0s(),e.j41(18,"div",8),e.DNE(19,P,1,0,"ion-progress-bar",9),e.k0s()()()),2&o&&(e.R7$(4),e.JRh(t.tituloLivro),e.R7$(6),e.R50("ngModel",t.tituloResenha),e.R7$(4),e.R50("ngModel",t.textoResenha),e.R7$(5),e.Y8G("ngIf",t.isSaving))},dependencies:[v.bT,u.me,u.BC,u.vS,a.Jm,a.W9,a.eU,a.$w,a.uz,a.he,a.FH,a.BC,a.ai,a.Gw],styles:[".description-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;padding:16px;gap:20px}.book-title-card[_ngcontent-%COMP%]{--ion-background-color: #f4f4f4;--ion-card-title-font-size: 1.2rem;--ion-color: #222;text-align:center;padding:10px}.title-input[_ngcontent-%COMP%]{--ion-background-color: #fff;--ion-color: #666;--highlight-color-focused: #3880ff;margin-bottom:16px}.custom-textarea-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.custom-textarea[_ngcontent-%COMP%]{width:100%;height:30vh;padding:10px;border-radius:10px;border:1px solid #ccc;font-size:1rem;resize:none;box-shadow:0 4px 6px #0000001a;transition:border-color .3s ease;background:#f9f9f9}.custom-textarea[_ngcontent-%COMP%]:focus{border-color:#3880ff;outline:none;box-shadow:0 4px 6px #3880ff33}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#333;font-size:1.4rem;margin-bottom:16px;line-height:1.5}ion-button[_ngcontent-%COMP%]{margin-top:10px}"]}),s})()}];let b=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[d.iI.forChild(M),d.iI]}),s})(),R=(()=>{var i;class s{}return(i=s).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[v.MD,u.YN,a.bv,b]}),s})()}}]);