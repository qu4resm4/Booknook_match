"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1452],{1452:(z,k,a)=>{a.r(k),a.d(k,{HomePageModule:()=>Y});var p=a(177),E=a(4341),l=a(4742),m=a(9384),d=a(467),e=a(4438),I=a(1626);let j=(()=>{var n;class o{constructor(t){this.http=t,this.API_URL="../../../assets/json/perfis.json"}getPerfis(){return this.http.get(this.API_URL)}}return(n=o).\u0275fac=function(t){return new(t||n)(e.KVO(I.Qq))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),o})();var y=a(1339),S=a(6589),w=a(6340);let H=(()=>{var n;class o{constructor(t,i){this.firestore=t,this.auth=i}likeUser(t){var i=this;return(0,d.A)(function*(){const s=yield i.auth.getCurrentUserId();if(!s)return;const f=i.firestore.collection("users").doc(s),M=i.firestore.collection("users").doc(t);try{yield i.firestore.firestore.runTransaction(function(){var u=(0,d.A)(function*(c){var g,h;const v=yield c.get(f.ref),P=yield c.get(M.ref);if(!v.exists||!P.exists)return;const A=(null===(g=v.data())||void 0===g?void 0:g.likes)||[],V=(null===(h=P.data())||void 0===h?void 0:h.likes)||[];if(c.update(f.ref,{likes:[...A,t]}),V.includes(s)){var C,_;c.update(f.ref,{matches:[...(null===(C=v.data())||void 0===C?void 0:C.matches)||[],t]}),c.update(M.ref,{matches:[...(null===(_=P.data())||void 0===_?void 0:_.matches)||[],s]});const F=i.generateChatId(s,t),O=i.firestore.collection("chats").doc(F),x=yield O.get().toPromise();null!=x&&x.exists||c.set(O.ref,{id:F,users:[s,t],messages:[],createdAt:(new Date).toISOString()})}});return function(c){return u.apply(this,arguments)}}())}catch(u){console.error("Erro ao processar o like:",u)}})()}generateChatId(t,i){return[t,i].sort().join("_")}}return(n=o).\u0275fac=function(t){return new(t||n)(e.KVO(w.Qe),e.KVO(y.u))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),o})();const R=["swipeCard"];function X(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,", "),e.k0s())}function $(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.DNE(2,X,2,0,"span",7),e.k0s()),2&n){const r=o.$implicit,t=o.index,i=e.XpG().$implicit;e.R7$(),e.SpI(" ",r,""),e.R7$(),e.Y8G("ngIf",t<i.categorias_livro.length-1)}}function b(n,o){if(1&n&&(e.j41(0,"div",6)(1,"h3"),e.EFF(2),e.k0s(),e.EFF(3),e.nrm(4,"br"),e.j41(5,"strong"),e.EFF(6,"Categorias:"),e.k0s(),e.DNE(7,$,3,2,"span",5),e.k0s()),2&n){const r=o.$implicit;e.R7$(2),e.JRh(r.titulo_resenha),e.R7$(),e.SpI(" ",r.resenha," "),e.R7$(4),e.Y8G("ngForOf",r.categorias_livro)}}function U(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,", "),e.k0s())}function G(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.DNE(2,U,2,0,"span",7),e.k0s()),2&n){const r=o.$implicit,t=o.index,i=e.XpG();e.R7$(),e.SpI(" ",r.preferencia," "),e.R7$(),e.Y8G("ngIf",t<i.perfil.interesses_usuario.length-1)}}let T=(()=>{var n;class o{constructor(t,i){this.gestureCtrl=t,this.match=i}ngAfterViewInit(){this.createSwipeGesture()}createSwipeGesture(){this.gestureCtrl.create({el:this.swipeCard.nativeElement,gestureName:"swipe-card",onMove:i=>this.onMove(i),onEnd:i=>this.onEnd(i)}).enable(!0)}onMove(t){const i=this.swipeCard.nativeElement;i.style.transform=`translateX(${t.deltaX}px) rotate(${t.deltaX/20}deg)`,t.deltaX>100?i.classList.add("like-animation"):t.deltaX<-100?i.classList.add("dislike-animation"):i.classList.remove("like-animation","dislike-animation")}onEnd(t){const i=this.swipeCard.nativeElement;t.deltaX>150?(console.log("direita / LIKE"),i.style.transition="0.5s ease-out",i.style.transform=`translateX(1000px) rotate(${t.deltaX/20}deg)`,i.remove(),this.match.likeUser(this.perfil.id_usuario)):t.deltaX<-150?(console.log("esquerda / DESLIKE"),i.style.transition="0.5s ease-out",i.style.transform=`translateX(-1000px) rotate(${t.deltaX/20}deg)`,i.remove()):(i.style.transition="0.3s ease-out",i.style.transform="translateX(0px) rotate(0deg)",i.classList.remove("like-animation","dislike-animation"))}resetCard(){const t=this.swipeCard.nativeElement;t.style.transition="",t.style.transform="",t.classList.remove("like-animation","dislike-animation")}}return(n=o).\u0275fac=function(t){return new(t||n)(e.rXU(l.wH),e.rXU(H))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-perfilmodal"]],viewQuery:function(t,i){if(1&t&&e.GBs(R,7,e.aKT),2&t){let s;e.mGM(s=e.lsd())&&(i.swipeCard=s.first)}},inputs:{perfil:"perfil"},decls:13,vars:3,consts:[["swipeCard",""],[1,"description-container"],["class","resenha-item",4,"ngFor","ngForOf"],[1,"info-section"],["name","book-outline",1,"info-icon"],[4,"ngFor","ngForOf"],[1,"resenha-item"],[4,"ngIf"]],template:function(t,i){1&t&&(e.j41(0,"ion-card",null,0)(2,"ion-card-content")(3,"h1"),e.EFF(4),e.k0s(),e.j41(5,"div",1)(6,"ion-text"),e.DNE(7,b,8,3,"div",2),e.k0s()(),e.j41(8,"div",3),e.nrm(9,"ion-icon",4),e.j41(10,"strong"),e.EFF(11,"Interesses:"),e.k0s(),e.DNE(12,G,3,2,"span",5),e.k0s()()()),2&t&&(e.R7$(4),e.SpI(" ",i.perfil.username," "),e.R7$(3),e.Y8G("ngForOf",i.perfil.resenhas),e.R7$(5),e.Y8G("ngForOf",i.perfil.interesses_usuario))},dependencies:[p.Sq,p.bT,l.b_,l.I9,l.iq,l.IO],styles:['@charset "UTF-8";ion-card[_ngcontent-%COMP%]{height:80vh;border-radius:14px;box-shadow:0 4px 8px #0000001a;margin:16px;position:relative;transition:transform .5s ease-out;will-change:transform}h1[_ngcontent-%COMP%]{margin:20px 15px 10px;font-weight:700}ion-card-content[_ngcontent-%COMP%]{padding:16px}.description-container[_ngcontent-%COMP%]{margin:20px 15px;max-height:52.5vh;text-align:justify;overflow-y:auto}.description-text[_ngcontent-%COMP%]{font-size:16px;line-height:1.5;text-align:justify;color:#444;margin:0 15px}.info-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap;gap:8px;margin:0 15px}.info-section[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .info-icon[_ngcontent-%COMP%]{margin-right:5px}.like-animation[_ngcontent-%COMP%]{border:2px solid green;box-shadow:0 4px 8px #00800080}.dislike-animation[_ngcontent-%COMP%]{border:2px solid red;box-shadow:0 4px 8px #ff000080}.like-animation[_ngcontent-%COMP%]:before, .dislike-animation[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:40px;font-weight:700;color:#fff;text-transform:uppercase}.like-animation[_ngcontent-%COMP%]:before{content:"Like";color:green}.dislike-animation[_ngcontent-%COMP%]:before{content:"Dislike";color:red}.resenha-item[_ngcontent-%COMP%]{margin-bottom:15px}.resenha-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.info-section[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:16px}']}),o})();function D(n,o){if(1&n&&e.nrm(0,"app-perfilmodal",5),2&n){const r=o.$implicit;e.xc7("position","absolute"),e.Y8G("perfil",r)}}const L=[{path:"",component:(()=>{var n;class o{constructor(t,i,s,f){this.router=t,this.PerfisService=i,this.authService=s,this.fire=f,this.userId="",this.perfis=[],this.limit=5}ionViewWillEnter(){this.loadMore()}getPerfis(){this.PerfisService.getPerfis().subscribe({next:t=>{this.perfis=t,console.log("sucesso JSON"),console.log(this.perfis)},error:t=>{console.error("Erro ao carregar dados",t)}})}loadMore(){this.fire.getUsers(this.limit).subscribe(t=>{const i=t.filter(s=>Object.keys(s).length>0);this.perfis=[...this.perfis,...i],console.log(this.perfis)})}redirecionandoFiltro(){var t=this;return(0,d.A)(function*(){yield t.router.navigate(["/filtro"])})()}redirecionandoPerfil(){var t=this;return(0,d.A)(function*(){yield t.router.navigate(["/perfil-usuario"])})()}ngOnInit(){}}return(n=o).\u0275fac=function(t){return new(t||n)(e.rXU(m.Ix),e.rXU(j),e.rXU(y.u),e.rXU(S.B))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-home"]],decls:7,vars:2,consts:[[3,"fullscreen"],["size","large","name","funnel-outline","slot","start",1,"ion-margin",3,"click"],["size","large","name","person-outline","slot","end",1,"ion-margin",3,"click"],[1,"modal-center"],[3,"perfil","position",4,"ngFor","ngForOf"],[3,"perfil"]],template:function(t,i){1&t&&(e.j41(0,"ion-content",0)(1,"ion-header")(2,"ion-toolbar")(3,"ion-icon",1),e.bIt("click",function(){return i.redirecionandoFiltro()}),e.k0s(),e.j41(4,"ion-icon",2),e.bIt("click",function(){return i.redirecionandoPerfil()}),e.k0s()()(),e.j41(5,"div",3),e.DNE(6,D,1,3,"app-perfilmodal",4),e.k0s()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(6),e.Y8G("ngForOf",i.perfis))},dependencies:[p.Sq,l.W9,l.eU,l.iq,l.ai,T],styles:[".modal-center[_ngcontent-%COMP%]{--margin-top: 50%;--margin-bottom: 50%}"]}),o})()}];let N=(()=>{var n;class o{}return(n=o).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[m.iI.forChild(L),m.iI]}),o})(),Y=(()=>{var n;class o{}return(n=o).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[p.MD,E.YN,l.bv,N]}),o})()}}]);